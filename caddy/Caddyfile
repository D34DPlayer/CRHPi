{
  log {
    level INFO
    output file /data/access.log {
      roll_size 10MB
      roll_keep 10
    }
  }
}

bw.{$DOMAIN_NAME} {
  tls {$EMAIL}
  encode gzip

  reverse_proxy /notifications/hub vaultwarden:3012

  reverse_proxy vaultwarden:80 {
       header_up X-Real-IP {remote_host}
  }
}

{$DOMAIN_NAME}, www.{$DOMAIN_NAME} {
  tls {$EMAIL}
  encode gzip

  handle /dns-query {
    reverse_proxy /dns-query doh:8053
  }

  handle {
    root * /usr/share/portfolio
    file_server
  }
}
